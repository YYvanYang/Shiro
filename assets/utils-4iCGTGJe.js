import{r as P,R as rt}from"./index-P88wRiLI.js";var S={BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0,SSR:!1};let st=0;function z(t,n){const c=`atom${++st}`,h={toString:()=>c};return typeof t=="function"?h.read=t:(h.init=t,h.read=it,h.write=ut),n&&(h.write=n),h}function it(t){return t(this)}function ut(t,n,c){return n(this,typeof c=="function"?c(t(this)):c)}const T=(t,n)=>t.unstable_is?t.unstable_is(n):n===t,L=t=>"init"in t,U=t=>!!t.write,C=new WeakMap,ct=(t,n)=>{C.set(t,n),t.catch(()=>{}).finally(()=>C.delete(t))},H=(t,n)=>{const c=C.get(t);c&&(C.delete(t),c(n))},K=(t,n)=>{t.status="fulfilled",t.value=n},X=(t,n)=>{t.status="rejected",t.reason=n},dt=t=>typeof(t==null?void 0:t.then)=="function",O=(t,n)=>!!t&&"v"in t&&"v"in n&&Object.is(t.v,n.v),Z=(t,n)=>!!t&&"e"in t&&"e"in n&&Object.is(t.e,n.e),M=t=>!!t&&"v"in t&&t.v instanceof Promise,lt=(t,n)=>"v"in t&&"v"in n&&t.v.orig&&t.v.orig===n.v.orig,N=t=>{if("e"in t)throw t.e;return t.v},ft=()=>{const t=new WeakMap,n=new WeakMap,c=new Map;let h,b;(S?"production":void 0)!=="production"&&(h=new Set,b=new Set);const f=e=>t.get(e),p=(e,r)=>{(S?"production":void 0)!=="production"&&Object.freeze(r);const s=t.get(e);if(t.set(e,r),c.has(e)||c.set(e,s),M(s)){const i="v"in r?r.v instanceof Promise?r.v:Promise.resolve(r.v):Promise.reject(r.e);s.v!==i&&H(s.v,i)}},v=(e,r,s,i)=>{const u=new Map(i?r.d:null);let l=!1;s.forEach((o,d)=>{!o&&T(e,d)&&(o=r),o?(u.set(d,o),r.d.get(d)!==o&&(l=!0)):(S?"production":void 0)!=="production"&&console.warn("[Bug] atom state not found")}),(l||r.d.size!==u.size)&&(r.d=u)},w=(e,r,s,i)=>{const u=f(e),l={d:(u==null?void 0:u.d)||new Map,v:r};if(s&&v(e,l,s,i),O(u,l)&&u.d===l.d)return u;if(M(u)&&M(l)&&lt(u,l)){if(u.d===l.d)return u;l.v=u.v}return p(e,l),l},g=(e,r,s,i)=>{if(dt(r)){let u;const l=()=>{const d=f(e);if(!M(d)||d.v!==o)return;const E=w(e,o,s);n.has(e)&&d.d!==E.d&&Y(e,E,d.d)},o=new Promise((d,E)=>{let a=!1;r.then(_=>{a||(a=!0,K(o,_),d(_),l())},_=>{a||(a=!0,X(o,_),E(_),l())}),u=_=>{a||(a=!0,_.then(m=>K(o,m),m=>X(o,m)),d(_))}});return o.orig=r,o.status="pending",ct(o,d=>{d&&u(d),i==null||i()}),w(e,o,s,!0)}return w(e,r,s)},A=(e,r,s)=>{const i=f(e),u={d:(i==null?void 0:i.d)||new Map,e:r};return s&&v(e,u,s),Z(i,u)&&i.d===u.d?i:(p(e,u),u)},y=(e,r)=>{const s=f(e);if(!r&&s&&(n.has(e)||Array.from(s.d).every(([a,_])=>{if(T(e,a))return!0;const m=y(a);return m===_||O(m,_)})))return s;const i=new Map;let u=!0;const l=a=>{if(T(e,a)){const m=f(a);if(m)return i.set(a,m),N(m);if(L(a))return i.set(a,void 0),a.init;throw new Error("no atom init")}const _=y(a);return i.set(a,_),N(_)};let o,d;const E={get signal(){return o||(o=new AbortController),o.signal},get setSelf(){return(S?"production":void 0)!=="production"&&!U(e)&&console.warn("setSelf function cannot be used with read-only atom"),!d&&U(e)&&(d=(...a)=>{if((S?"production":void 0)!=="production"&&u&&console.warn("setSelf function cannot be called in sync"),!u)return I(e,...a)}),d}};try{const a=e.read(l,E);return g(e,a,i,()=>o==null?void 0:o.abort())}catch(a){return A(e,a,i)}finally{u=!1}},F=e=>N(y(e)),et=e=>{let r=n.get(e);return r||(r=V(e)),r},j=(e,r)=>!r.l.size&&(!r.t.size||r.t.size===1&&r.t.has(e)),nt=e=>{const r=n.get(e);r&&j(e,r)&&D(e)},q=e=>{const r=new Map,s=new WeakMap,i=o=>{var d;const E=new Set((d=n.get(o))==null?void 0:d.t);return c.forEach((a,_)=>{var m;(m=f(_))!=null&&m.d.has(o)&&E.add(_)}),E},u=o=>{i(o).forEach(d=>{d!==o&&(r.set(d,(r.get(d)||new Set).add(o)),s.set(d,(s.get(d)||0)+1),u(d))})};u(e);const l=o=>{i(o).forEach(d=>{var E;if(d!==o){let a=s.get(d);if(a&&s.set(d,--a),!a){let _=!!((E=r.get(d))!=null&&E.size);if(_){const m=f(d),ot=y(d,!0);_=!O(m,ot)}_||r.forEach(m=>m.delete(d))}l(d)}})};l(e)},x=(e,...r)=>{let s=!0;const i=o=>N(y(o)),u=(o,...d)=>{let E;if(T(e,o)){if(!L(o))throw new Error("atom not writable");const a=f(o),_=g(o,d[0]);O(a,_)||q(o)}else E=x(o,...d);if(!s){const a=R();(S?"production":void 0)!=="production"&&h.forEach(_=>_({type:"async-write",flushed:a}))}return E},l=e.write(i,u,...r);return s=!1,l},I=(e,...r)=>{const s=x(e,...r),i=R();return(S?"production":void 0)!=="production"&&h.forEach(u=>u({type:"write",flushed:i})),s},V=(e,r,s)=>{var i;const u=s||[];(i=f(e))==null||i.d.forEach((o,d)=>{const E=n.get(d);E?E.t.add(e):d!==e&&V(d,e,u)}),y(e);const l={t:new Set(r&&[r]),l:new Set};if(n.set(e,l),(S?"production":void 0)!=="production"&&b.add(e),U(e)&&e.onMount){const{onMount:o}=e;u.push(()=>{const d=o((...E)=>I(e,...E));d&&(l.u=d)})}return s||u.forEach(o=>o()),l},D=e=>{var r;const s=(r=n.get(e))==null?void 0:r.u;s&&s(),n.delete(e),(S?"production":void 0)!=="production"&&b.delete(e);const i=f(e);i?(M(i)&&H(i.v),i.d.forEach((u,l)=>{if(l!==e){const o=n.get(l);o&&(o.t.delete(e),j(l,o)&&D(l))}})):(S?"production":void 0)!=="production"&&console.warn("[Bug] could not find atom state to unmount",e)},Y=(e,r,s)=>{const i=new Set(r.d.keys()),u=new Set;s==null||s.forEach((l,o)=>{if(i.has(o)){i.delete(o);return}u.add(o);const d=n.get(o);d&&d.t.delete(e)}),i.forEach(l=>{const o=n.get(l);o?o.t.add(e):n.has(e)&&V(l,e)}),u.forEach(l=>{const o=n.get(l);o&&j(l,o)&&D(l)})},R=()=>{let e;for((S?"production":void 0)!=="production"&&(e=new Set);c.size;){const r=Array.from(c);c.clear(),r.forEach(([s,i])=>{const u=f(s);if(u){const l=n.get(s);l&&u.d!==(i==null?void 0:i.d)&&Y(s,u,i==null?void 0:i.d),l&&!(!M(i)&&(O(i,u)||Z(i,u)))&&(l.l.forEach(o=>o()),(S?"production":void 0)!=="production"&&e.add(s))}else(S?"production":void 0)!=="production"&&console.warn("[Bug] no atom state to flush")})}if((S?"production":void 0)!=="production")return e},G=(e,r)=>{const s=et(e),i=R(),u=s.l;return u.add(r),(S?"production":void 0)!=="production"&&h.forEach(l=>l({type:"sub",flushed:i})),()=>{u.delete(r),nt(e),(S?"production":void 0)!=="production"&&h.forEach(l=>l({type:"unsub"}))}};return(S?"production":void 0)!=="production"?{get:F,set:I,sub:G,dev_subscribe_store:(e,r)=>{if(r!==2)throw new Error("The current StoreListener revision is 2.");return h.add(e),()=>{h.delete(e)}},dev_get_mounted_atoms:()=>b.values(),dev_get_atom_state:e=>t.get(e),dev_get_mounted:e=>n.get(e),dev_restore_atoms:e=>{for(const[s,i]of e)L(s)&&(g(s,i),q(s));const r=R();h.forEach(s=>s({type:"restore",flushed:r}))}}:{get:F,set:I,sub:G}};let B;(S?"production":void 0)!=="production"&&(typeof globalThis.__NUMBER_OF_JOTAI_INSTANCES__=="number"?++globalThis.__NUMBER_OF_JOTAI_INSTANCES__:globalThis.__NUMBER_OF_JOTAI_INSTANCES__=1);const Q=()=>(B||((S?"production":void 0)!=="production"&&globalThis.__NUMBER_OF_JOTAI_INSTANCES__!==1&&console.warn("Detected multiple Jotai instances. It may cause unexpected behavior with the default store. https://github.com/pmndrs/jotai/discussions/2044"),B=ft()),B);var at={BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const vt=P.createContext(void 0),tt=t=>{const n=P.useContext(vt);return(t==null?void 0:t.store)||n||Q()},ht=t=>typeof(t==null?void 0:t.then)=="function",wt=rt.use||(t=>{if(t.status==="pending")throw t;if(t.status==="fulfilled")return t.value;throw t.status==="rejected"?t.reason:(t.status="pending",t.then(n=>{t.status="fulfilled",t.value=n},n=>{t.status="rejected",t.reason=n}),t)});function _t(t,n){const c=tt(n),[[h,b,f],p]=P.useReducer(g=>{const A=c.get(t);return Object.is(g[0],A)&&g[1]===c&&g[2]===t?g:[A,c,t]},void 0,()=>[c.get(t),c,t]);let v=h;(b!==c||f!==t)&&(p(),v=c.get(t));const w=n==null?void 0:n.delay;return P.useEffect(()=>{const g=c.sub(t,()=>{if(typeof w=="number"){setTimeout(p,w);return}p()});return p(),g},[c,t,w]),P.useDebugValue(v),ht(v)?wt(v):v}function pt(t,n){const c=tt(n);return P.useCallback((...b)=>{if((at?"production":void 0)!=="production"&&!("write"in t))throw new Error("not writable atom");return c.set(t,...b)},[c,t])}function Pt(t,n){return[_t(t,n),pt(t,n)]}let W,k=Symbol(),gt=()=>{if(W)return W;if(globalThis[k])return globalThis[k];let t=Q();return W=t,globalThis[k]=t,t};const Ot=gt();var $={BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const Et=Symbol(($?"production":void 0)!=="production"?"RESET":""),J=(t,n,c)=>(n.has(c)?n:n.set(c,t())).get(c),bt=new WeakMap,St=(t,n,c,h)=>{const b=J(()=>new WeakMap,bt,n),f=J(()=>new WeakMap,b,c);return J(t,f,h)};function It(t,n,c=Object.is){return St(()=>{const h=Symbol(),b=([p,v])=>{if(v===h)return n(p);const w=n(p,v);return c(v,w)?v:w},f=z(p=>{const v=p(f),w=p(t);return w instanceof Promise||v instanceof Promise?Promise.all([w,v]).then(b):b([w,v])});return f.init=h,f},t,n,c)}const At=t=>typeof(t==null?void 0:t.then)=="function";function mt(t=()=>{try{return window.localStorage}catch(c){($?"production":void 0)!=="production"&&typeof window<"u"&&console.warn(c);return}},n){let c,h;const b={getItem:(f,p)=>{var v,w;const g=y=>{if(y=y||"",c!==y){try{h=JSON.parse(y,n==null?void 0:n.reviver)}catch{return p}c=y}return h},A=(w=(v=t())==null?void 0:v.getItem(f))!=null?w:null;return At(A)?A.then(g):g(A)},setItem:(f,p)=>{var v;return(v=t())==null?void 0:v.setItem(f,JSON.stringify(p,n==null?void 0:n.replacer))},removeItem:f=>{var p;return(p=t())==null?void 0:p.removeItem(f)}};return typeof window<"u"&&typeof window.addEventListener=="function"&&window.Storage&&(b.subscribe=(f,p,v)=>{if(!(t()instanceof window.Storage))return()=>{};const w=g=>{if(g.storageArea===t()&&g.key===f){let A;try{A=JSON.parse(g.newValue||"")}catch{A=v}p(A)}};return window.addEventListener("storage",w),()=>{window.removeEventListener("storage",w)}}),b}const yt=mt();function Rt(t,n,c=yt,h){const b=h==null?void 0:h.getOnInit,f=z(b?c.getItem(t,n):n);return($?"production":void 0)!=="production"&&(f.debugPrivate=!0),f.onMount=v=>{b||v(c.getItem(t,n));let w;return c.subscribe&&(w=c.subscribe(t,v,n)),w},z(v=>v(f),(v,w,g)=>{const A=typeof g=="function"?g(v(f)):g;return A===Et?(w(f,n),c.removeItem(t)):A instanceof Promise?A.then(y=>(w(f,y),c.setItem(t,y))):(w(f,A),c.setItem(t,A))})}export{z as a,pt as b,Rt as c,tt as d,Pt as e,Ot as j,gt as r,It as s,_t as u};
